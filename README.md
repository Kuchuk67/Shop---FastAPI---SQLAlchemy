# Сервис покупки товаров для авторизованных пользователей
Данный раздел содержит информацию по описанию сервиса.\
**Руководство по запуску** проекта  [TODO.md](./TODO.md).\
Документация API 127.0.0.1:8000/api/v1/docs

Представляет API-сервис для поддержки функционала интернет-магазина. 
Содержит три части: 
авторизация пользователя, каталог товаров (витрина), корзина покупок.

Полнофункциональный, безопасный и масштабируемый API-сервис с модульной архитектурой, готовый к расширению и интеграции в e-commerce проекты.

### Используются технологии:

- **FastAPI** asinc
- **PostgreSQL**
- **SQLAlchemy**
- Аутентификация **JWT**
- Валидация **Pydentic**
- Контейнеризация **Docker** и **Docker compose**

### Основная файловая структура проекта
```
backend
   app
	core
	    models
		... описание моделей и работа с БД
	shopcase
		... модуль каталога товаров
	users
		... модуль авторизации
		authorization.py Аутантификация пользователя
   tests
      ... тесты
   config.py
   main.py
   .env
   ...
docker-compose.yaml
Dockerfile
start
README.md
TODO.md
```

### Схема моделей проекта
```
    ---User---
+-- id
|   full_name: str
|   email: str
|   phone: str
|   password: str
|   disabled: bool
|   roles: str
|
|   ---Cart---
|   id
+-< user_id: int
    price: int
    quantity: int
+-< product_id: int
|  
|
|   ---ProductShop---
+-- id
    name: str
    description: str
    price: int
    quantity: int
    created_at: datetime
    updated_at: datetime
    is_active: bool
```


- ## Авторизация пользователя
Модуль Users app/users
Обеспечивает регистрацию пользователей, аутентификацию пользователя и выдачу JWT, авторизацию и методы работы с моделью Users.
Регистрация пользователя. 
Принимает запрос с параметрами согластно api/v1/docs

Проверки:
- Уникальность полей email и phone
- Валидность полей проверяется Pydentic согластно схеме
- Валидность пароля проверяется регулярным выражнием
- Email и телефон — уникальныея
Создает модель User в БД


Аутентификация по email или телефону + пароль
Принимает запрос с параметрами согластно api/v1/docs
Идентифицирует пользователя и выдает ему
JWT доступа и рефреш JWT
время действия указываются в .env

Идентифицированный по jwt доступа пользователь 
авторизируется согластно его роли



- ## Каталог товаров (витрина)
    • CRUD-операции доступны только администраторам
    • Для обычных пользователей — только просмотр активных товаров 
    и количество которых больше 0

- ## Корзина покупок
    Поддержка добавления, удаления и очистки товаров в корзине


1. **Регистрация пользователей:** 
   - Создать метод для регистрации пользователей с полями: ФИО, email (уникальный), телефон (уникальный), пароль и подтверждение пароля. Все поля обязательны.
   - Пароль должен соответствовать следующим требованиям: не менее 8 символов, только латиница, минимум 1 символ верхнего регистра, минимум 1 спец символ ($%&!:).
   - Телефон должен начинаться с +7 и содержать 10 цифр.
2. **Авторизация пользователей:** 
   - Создать метод для авторизации пользователей с использованием email или телефона и пароля.
   - После авторизации пользователь получает доступ к списку всех активных товаров в базе данных.
3. **Работа с товарами:** 
   - Создать таблицу товаров с полями: name (str), price (int), created_at (datetime), updated_at (datetime), is_active (bool).
   - Реализовать методы для добавления, редактирования и удаления товаров (доступны только администратору).
4. **Корзина:** 
   - Создать объект корзины, который будет содержать список товаров.
   - Реализовать методы для добавления товаров в корзину (одного или нескольких), удаления товаров из корзины и полной очистки корзины.
   - Реализовать метод для получения общей стоимости товаров в корзине.
5. **Доступ к API:** 
   - Методы регистрации и авторизации доступны всем пользователям без аутентификации.
   - Методы для работы с товарами и корзиной доступны только авторизованным пользователям.
   - При попытке неавторизованного доступа возвращать ошибку {code: 401, message: "Unauthorized"} с HTTP статусом 401.

 





   